{% extends "base.html" %}
{% load static %}
{% load core_extras %}
{% load minutes_tags %}
{% load bootstrap_icons %}

{% block content %}
{% with page.body|markdown as parsed_md %}
<div class="minutes-container row flex-lg-row">
    <a id="side-panel-toggle" href="#toc" class="d-grid d-lg-none">
        <button type="button" class="btn btn-light mb-3" aria-label="Jump to Table of Contents">
            {% bs_icon 'list-ol' size='1.3rem' %}
            Table of Contents
        </button>
    </a>

    <div class="col-lg-9">
        <h1 class="page-title">
            <span class="underline">
                {{ page.title }}
            </span>
        </h1>
        {{ parsed_md.0 }}
    </div>

    <div id="side-column" class="col-lg-3">
        <div id="side-panel-container" class="bg-white mb-3">
            <aside class="side-panel border-accent">
                <h1 class="toc-title">Date</h1>
                <p>{{ page.date|date:"d.m.Y" }}</p>

                <h1 class="toc-title">Moderator</h1>
                <p>{{ page.moderator.get_full_name }}</p>

                <h1 class="toc-title">Minutes Taker</h1>
                <p>{{ page.author.get_full_name }}</p>

                <h1 class="toc-title">Participants</h1>
                <p>
                    {% for participant in page.participants.all %}
                    {{ participant.get_full_name }}
                    {% if foorloop.counter < page.participants.all|length %}
                    </br>
                    {% endif %}
                    {% endfor %}
                </p>

                <h1 class="toc-title">Guests</h1>
                <p>
                    {% if page.guests %}
                <p>
                    {% for guest in page.guests %}
                    {{ guest }}</br>
                    {% endfor %}
                </p>
                {% else %}
                <i>No guests</i>
                {% endif %}
                </p>

                <h1 class="toc-title">Labels</h1>
                <p>
                    {%  if page.labels.all %}
                    {% include "core/label.html" with minutes=page %}
                    {% else %}
                    <i>No labels</i>
                    {% endif %}
                </p>
            </aside>

            <aside class="side-panel border-accent toc-container d-print-none">
                <h1 id="toc" class="toc-title">Table of Contents</h1>
                {{ parsed_md.1 }}
            </aside>

            {% if page.attachments.all %}
            <aside class="side-panel border-accent toc-container d-print-none">
                <h1 class="toc-title">Attachments</h1>
                <ul>
                    {% for attachment in page.attachments.all %}
                    <li>
                        <a href="{{ attachment.url }}">{{ attachment.title }}</a>
                    </li>
                    {% endfor %}
                </ul>
            </aside>
            {% endif %}
        </div>
    </div>
    {% endwith %}
</div>
{% block extra_js %}
<script type="text/javascript" src="{% static 'js/print_processor.js' %}"></script>
{% endblock %}
{% endblock %}